<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>NPA Smart Admin v4.2 â€” 3iReborn</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg1:#0b1f3a; --bg2:#0f2d57; --card:#102a43;
      --btn1:#2bb0ed; --btn2:#0ea5e9; --ok:#22c55e; --warn:#f59e0b; --bad:#ef4444; --txt:#e6f2ff;
    }
    *{box-sizing:border-box} body{
      margin:0; font-family:Poppins,system-ui,-apple-system,Segoe UI,Roboto,Arial,Helvetica,sans-serif;
      color:var(--txt); background:linear-gradient(180deg,var(--bg1),var(--bg2)) fixed;
      min-height:100dvh; display:flex; align-items:center; justify-content:center; padding:24px;
    }
    .wrap{width:100%; max-width:760px}
    .card{background:rgba(16,42,67,.7); backdrop-filter: blur(6px);
      border:1px solid rgba(255,255,255,.08); border-radius:18px; padding:20px; box-shadow:0 10px 30px rgba(0,0,0,.25)}
    h1{font-size:28px; margin:0 0 6px} .sub{opacity:.85; margin:6px 0 16px}
    .status{display:inline-flex; align-items:center; gap:8px; font-weight:600; margin:6px 0 16px}
    .dot{width:10px; height:10px; border-radius:50%}
    .ok{background:var(--ok)} .warn{background:var(--warn)} .bad{background:var(--bad)}
    input,button{font:600 16px Poppins, sans-serif}
    input{
      width:100%; padding:14px 16px; border-radius:12px; border:1px solid rgba(255,255,255,.12);
      background:rgba(255,255,255,.06); color:#fff; outline:none
    }
    input::placeholder{color:#cfe6ff80; font-weight:500}
    .row{display:grid; grid-template-columns:1fr; gap:12px; margin-top:12px}
    .btn{display:block; width:100%; text-align:center; padding:14px 16px; border-radius:12px;
      background:linear-gradient(90deg,var(--btn1),var(--btn2)); color:#04243d; font-weight:800; border:none; cursor:pointer}
    .btn.ghost{background:transparent; color:#cfe6ff; border:1px solid rgba(255,255,255,.16)}
    .btn.red{background:linear-gradient(90deg,#fb7185,#ef4444); color:#fff}
    .btn.green{background:linear-gradient(90deg,#34d399,#10b981); color:#052014}
    .grid{display:grid; grid-template-columns:1fr; gap:12px; margin-top:14px}
    .menu .btn{background:rgba(255,255,255,.06); color:#e8f6ff; border:1px solid rgba(255,255,255,.12)}
    .menu .btn:hover{background:rgba(255,255,255,.12)}
    @media (min-width:680px){ .grid{grid-template-columns:1fr 1fr} }
    .muted{opacity:.8; font-size:13px; margin-top:10px}
    .center{display:flex; gap:10px; align-items:center; justify-content:center; flex-wrap:wrap}
    a.btn{text-decoration:none}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <h1>ğŸŒ NPA Smart Admin v4.2</h1>
      <div id="loginState" class="status"><span class="dot warn"></span><span>Belum Login</span></div>

      <!-- PUBLIC: Tambah Mitra (tanpa login) -->
      <div class="row">
        <a id="btnAddPublic" class="btn green" href="#">â• Tambah Mitra Baru (Tanpa Login)</a>
      </div>

      <!-- LOGIN AREA -->
      <div class="row" style="margin-top:14px">
        <input id="token" type="password" placeholder="Masukkan Token GitHubâ€¦" autocomplete="off">
        <button class="btn" id="btnLogin">Login Sekarang</button>
        <button class="btn ghost" id="btnCheck">ğŸ” Lihat Status Token</button>
      </div>

      <!-- MENU AFTER LOGIN -->
      <div id="menu" class="menu" style="display:none">
        <div class="grid" style="margin-top:18px">
          <a class="btn" id="linkLeader">ğŸ‘¥ Kelola Leader & Link Pendaftaran</a>
          <a class="btn" id="linkMaster">ğŸŒ LP Master</a>
          <a class="btn" id="linkHot">ğŸ”¥ LP Hot</a>
          <a class="btn" id="linkAI">ğŸ¤– AI Tools</a>
          <a class="btn" id="linkFU">ğŸ“ Follow-Up 179</a>
          <a class="btn" id="linkRem">ğŸ—“ï¸ Reminder 18-29-10-15</a>
          <a class="btn" id="linkMon">ğŸŒ Monday Booster</a>
          <a class="btn" id="linkAdd">â• Tambah Mitra (Halaman Khusus)</a>
        </div>
        <div class="row" style="margin-top:12px">
          <button class="btn red" id="btnChange">ğŸ§© Ganti Token</button>
          <button class="btn ghost" id="btnLogout">ğŸšª Logout</button>
        </div>
      </div>

      <div class="center muted">
        <span>Repo: <b id="repoLbl">3ireborn/pendaftaran-online</b></span> â€¢
        <span>Token tersimpan lokal & terenkripsi browser</span>
      </div>
    </div>
  </div>

  <script>
    // ====== LINKS CONFIG â€“ ganti jika path file berbeda di repo-mu ======
    const LINKS = {
      // halaman daftar leader dengan tombol LP/WA (yang pernah kamu pakai)
      leadersHub: 'admin-cloud-safe-v3.html',
      // modul mandiri
      lpMaster: 'master-lp.html',         // biasanya butuh ?leader=slug â†’ masuk via Leaders Hub
      lpHot: 'lp-hot.html',               // idem
      aiTools: 'ai-tools.html',
      followUp: 'followup179.html',
      reminder: 'reminder-booster.html#reminder',
      monday: 'reminder-booster.html#booster',
      addMitra: 'add-mitra.html'          // public
    };

    // ====== STORAGE KEYS ======
    const KEY = 'gh_token';

    const $ = (s)=>document.querySelector(s);
    const loginState = $('#loginState');
    const tokenInput = $('#token');
    const menu = $('#menu');

    const btnLogin = $('#btnLogin');
    const btnCheck = $('#btnCheck');
    const btnChange = $('#btnChange');
    const btnLogout = $('#btnLogout');

    // public add-mitra link
    const base = location.pathname.replace(/[^/]+$/,''); // folder current
    const jump = (rel)=> location.href = base + rel;

    $('#btnAddPublic').href = base + LINKS.addMitra;

    // after login: set links
    const setLinks = ()=>{
      $('#linkLeader').href = base + LINKS.leadersHub;
      $('#linkMaster').href = base + LINKS.leadersHub;  // biar pilih leader dulu (anti 404)
      $('#linkHot').href    = base + LINKS.leadersHub;  // idem
      $('#linkAI').href     = base + LINKS.aiTools;
      $('#linkFU').href     = base + LINKS.followUp;
      $('#linkRem').href    = base + LINKS.reminder;
      $('#linkMon').href    = base + LINKS.monday;
      $('#linkAdd').href    = base + LINKS.addMitra;
    };

    // UI helpers
    function setStatus(type, text){
      const dot = loginState.querySelector('.dot');
      dot.className = 'dot ' + (type==='ok'?'ok':type==='bad'?'bad':'warn');
      loginState.lastElementChild.textContent = text;
    }
    function showMenu(show){ menu.style.display = show ? 'block':'none'; }

    // init
    (function init(){
      setLinks();
      const saved = localStorage.getItem(KEY);
      if(saved){
        tokenInput.value = 'â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢';
        setStatus('ok','Login Aman â€” Token Lokal Aktif');
        showMenu(true);
      }else{
        setStatus('warn','Belum Login');
        showMenu(false);
      }
    })();

    // login
    btnLogin.addEventListener('click', ()=>{
      const t = tokenInput.value.trim();
      if(!t || t.startsWith('â€¢â€¢')){ alert('Masukkan token GitHub yang valid.'); return; }
      localStorage.setItem(KEY, t);
      tokenInput.value = 'â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢';
      setStatus('ok','Login Aman â€” Token Lokal Aktif');
      showMenu(true);
      alert('âœ… Token disimpan lokal. Kamu sudah login.');
    });

    // cek status token (rate limit endpoint)
    btnCheck.addEventListener('click', async ()=>{
      const t = localStorage.getItem(KEY) || tokenInput.value.trim();
      if(!t){ alert('Belum ada token. Masukkan token dulu ya.'); return; }
      setStatus('warn','Mengecek tokenâ€¦');
      try{
        const res = await fetch('https://api.github.com/rate_limit', {
          headers:{ Authorization: 'token '+t, 'Accept':'application/vnd.github+json' }
        });
        if(res.status===401){ setStatus('bad','Token tidak valid / expired'); return; }
        const js = await res.json();
        const remain = js.resources?.core?.remaining ?? 0;
        setStatus('ok', `Token valid â€” sisa kuota: ${remain}`);
        alert('âœ… Token valid. Sisa kuota API: '+remain);
      }catch(e){
        setStatus('bad','Gagal cek token (jaringan?)');
        alert('Gagal cek token. Coba lagi.');
      }
    });

    // ganti token (reset input)
    btnChange.addEventListener('click', ()=>{
      tokenInput.value = '';
      tokenInput.focus();
      setStatus('warn','Isi token baru lalu klik Login');
    });

    // logout
    btnLogout.addEventListener('click', ()=>{
      localStorage.removeItem(KEY);
      tokenInput.value = '';
      setStatus('warn','Belum Login');
      showMenu(false);
      alert('Kamu sudah logout. Token lokal dihapus.');
    });
  </script>
</body>
</html>
