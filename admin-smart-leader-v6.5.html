<!doctype html>
<html lang="id">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>NPA Smart â€” Admin Leader v6.5</title>
<meta name="theme-color" content="#0b1220">
<style>
  :root{
    --bg:#0b1220;--card:#121a2b;--muted:#96a0b5;--text:#e8eefc;--brand:#ffd34d;
    --accent:#21d07a;--accent2:#2d6dff;--danger:#ff5a64;--chip:#19223a;--link:#8fb4ff;
    --shadow: 0 8px 24px rgba(0,0,0,.35), 0 2px 6px rgba(0,0,0,.2);
    --radius:18px
  }
  *{box-sizing:border-box} html,body{margin:0;background:var(--bg);color:var(--text);font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Helvetica,Arial,sans-serif}
  a{color:var(--link);word-break:break-all}
  .wrap{max-width:820px;margin:24px auto;padding:16px}
  .badge{display:inline-flex;gap:.5rem;align-items:center;background:linear-gradient(180deg,#16223a,#121a2b);border:1px solid #26304a;border-radius:999px;padding:8px 14px;color:#cfe0ff;box-shadow:var(--shadow)}
  .title{font-weight:800;font-size:clamp(22px,4vw,34px);line-height:1.2;margin:10px 0 4px}
  .subtitle{color:var(--muted);margin:0 0 18px}
  .card{background:var(--card);border:1px solid #233054;border-radius:var(--radius);padding:18px;box-shadow:var(--shadow);margin:16px 0}
  .row{display:grid;grid-template-columns:1fr;gap:12px}
  @media(min-width:560px){.row{grid-template-columns:1fr 1fr}}
  label{font-size:.92rem;color:#c9d7f2}
  input,select,textarea{
    width:100%;padding:14px 14px;border-radius:14px;border:1px solid #2a3a5f;background:#0f1627;
    color:var(--text);outline:none;transition:.15s;box-shadow:inset 0 1px 0 rgba(255,255,255,.03)
  }
  input:focus,select:focus,textarea:focus{border-color:#3c64ff;box-shadow:0 0 0 3px rgba(60,100,255,.2)}
  .btn{display:inline-flex;align-items:center;gap:.6rem;padding:12px 16px;border-radius:14px;
       font-weight:700;border:none;cursor:pointer;transition:.15s}
  .btn:active{transform:translateY(1px)}
  .btn-primary{background:var(--accent2);color:white}
  .btn-green{background:var(--accent);color:#052410}
  .btn-ghost{background:transparent;color:#cfe0ff;border:1px dashed #3a4a70}
  .btn-copy{background:#203055;color:#dfe8ff}
  .btn-wa{background:#25D366;color:#06250f}
  .cap{color:var(--muted);font-size:.92rem}
  .chips{display:flex;flex-wrap:wrap;gap:8px}
  .chip{background:var(--chip);border:1px solid #2a3656;color:#bcd3ff;padding:6px 10px;border-radius:999px;font-size:.86rem}
  .kpi{display:flex;gap:10px;align-items:center}
  .kpi .dot{width:10px;height:10px;border-radius:50%;background:#f44;box-shadow:0 0 12px #f44}
  .kpi.ok .dot{background:#21d07a;box-shadow:0 0 12px #21d07a}
  .links>div{background:#0f1729;border:1px solid #273457;border-radius:14px;padding:14px;margin:10px 0}
  .muted{color:var(--muted)}
  .small{font-size:.86rem}
</style>
</head>
<body>
  <div class="wrap">
    <div class="badge">âœ¨ <b>NPA Smart â€” Admin Leader v6.5</b></div>
    <div class="title">Tambah Mitra &amp; Buat 3 Link Otomatis</div>
    <p class="subtitle">Halaman ringan untuk leader. Token FonNTE disembunyikan (tersambung otomatis dari Admin Pusat).</p>

    <!-- Status sambungan (disembunyikan tokennya, hanya indikator) -->
    <div class="card kpi" id="tokenStatus">
      <div class="dot" id="tokenDot"></div>
      <div>
        <div><b>Status FonNTE:</b> <span id="tokenText">Memeriksaâ€¦</span></div>
        <div class="small muted">Token tidak ditampilkan. Bila Admin Pusat pernah set token di perangkat ini, sistem follow-up tetap aktif.</div>
      </div>
    </div>

    <!-- Form pembuatan link -->
    <div class="card">
      <h3 style="margin:0 0 12px">ðŸ§© Data Leader</h3>
      <div class="row">
        <div>
          <label>Nama Leader</label>
          <input id="name" placeholder="cth: Sugiarto Kurniawan" autocomplete="name">
        </div>
        <div>
          <label>No. WhatsApp (format 62â€¦)</label>
          <input id="wa" placeholder="62812xxxxxxxx" inputmode="numeric" autocomplete="tel">
        </div>
      </div>
      <div class="row" style="margin-top:8px">
        <div>
          <label>Slug (opsional)</label>
          <input id="slug" placeholder="cth: team-sukses">
        </div>
        <div style="display:flex;align-items:flex-end;gap:10px;flex-wrap:wrap">
          <button class="btn btn-green" id="btnGen">ðŸš€ Buat 3 Link</button>
          <button class="btn btn-ghost" id="btnClear">ðŸ§¹ Bersihkan</button>
        </div>
      </div>
      <div class="cap" style="margin-top:10px">ID/kode/slug otomatis diambil dari nama bila tidak diisi.</div>
    </div>

    <!-- Hasil -->
    <div class="card" id="resultCard" style="display:none">
      <h3 style="margin:0 0 8px">ðŸ”— Tautan Pribadi</h3>
      <div class="links" id="linksBox"></div>
      <div class="chips" style="margin-top:8px">
        <button class="btn btn-copy" id="btnCopy">ðŸ“‹ Salin Semua Link</button>
        <button class="btn btn-wa" id="btnShareWa">ðŸ“² Kirim ke WhatsApp</button>
      </div>
      <div class="cap" style="margin-top:10px">Link siap dibagikan ke calon mitra: LP Master â†’ LP Hot â†’ Form Pendaftaran.</div>
    </div>

    <!-- Footer info -->
    <div class="card">
      <div class="row">
        <div>
          <div class="muted">Waktu (WIB)</div>
          <div style="font-weight:800;font-size:1.2rem" id="clock">--:--:--</div>
        </div>
        <div>
          <div class="muted">Catatan</div>
          <div class="small">Token tersimpan lokal (browser) bila sebelumnya diatur di Admin Pusat. Leader tidak perlu mengisi token apa pun.</div>
        </div>
      </div>
    </div>

    <p class="muted small">Powered by NPA Smart System Ã— 3iReborn</p>
  </div>

<script>
  // ================== Util & State ==================
  const qs = s => document.querySelector(s);
  const nameEl = qs('#name'), waEl = qs('#wa'), slugEl = qs('#slug');
  const resultCard = qs('#resultCard'), linksBox = qs('#linksBox');

  // kunci localStorage yang digunakan Admin Pusat
  const FONNTE_KEY = 'fonnte_token';   // token disembunyikan, hanya indikator status
  const LEADER_CACHE = 'npa_leader_cache_v65';

  // WIB clock
  function tickClock(){
    try{
      const now = new Date().toLocaleString('id-ID',{timeZone:'Asia/Jakarta', hour:'2-digit', minute:'2-digit', second:'2-digit'});
      qs('#clock').textContent = now.replaceAll('.',':');
    }catch(e){
      qs('#clock').textContent = new Date().toTimeString().slice(0,8);
    }
  }
  setInterval(tickClock, 1000); tickClock();

  // indikator token
  (function initTokenIndicator(){
    const has = !!localStorage.getItem(FONNTE_KEY);
    qs('#tokenText').textContent = has ? 'Aktif (tersimpan lokal)' : 'Tidak ditemukan';
    const box = qs('#tokenStatus');
    if(has) box.classList.add('ok');
    (has ? qs('#tokenDot').classList.add('ok') : null);
  })();

  // cache isi terakhir
  (function hydrate(){
    try{
      const last = JSON.parse(localStorage.getItem(LEADER_CACHE)||'{}');
      if(last.name) nameEl.value = last.name;
      if(last.wa) waEl.value = last.wa;
      if(last.slug) slugEl.value = last.slug;
    }catch(_){}
  })();

  function toSlug(str){
    return (str||'')
      .toLowerCase()
      .normalize('NFKD').replace(/[\u0300-\u036f]/g,'') // strip accent
      .replace(/[^a-z0-9]+/g,'-').replace(/^-+|-+$/g,'').slice(0,48) || 'my-link';
  }
  function enc(v){ return encodeURIComponent(v||''); }

  function validate(){
    const name = nameEl.value.trim();
    const wa = (waEl.value||'').trim();
    if(!name){ alert('Nama leader wajib diisi.'); nameEl.focus(); return; }
    if(!/^62\d{7,15}$/.test(wa)){ alert('Nomor WA harus format 62xxxxxxxx (tanpa +).'); waEl.focus(); return; }
    return { name, wa, slug: (slugEl.value.trim() || toSlug(name)) };
  }

  function buildLinks({name,wa,slug}){
    const base = 'https://3ireborn.github.io/pendaftaran-online';
    return [
      {
        title:'ðŸŒ LP Master',
        url:`${base}/lp-master.html?name=${enc(name)}&wa=${enc(wa)}&slug=${enc(slug)}`
      },
      {
        title:'ðŸ”¥ LP Hot',
        url:`${base}/lp-hot.html?name=${enc(name)}&wa=${enc(wa)}&slug=${enc(slug)}`
      },
      {
        title:'ðŸ“ Form Pendaftaran',
        url:`${base}/form-pendaftaran-v3.1.html?name=${enc(name)}&wa=${enc(wa)}&slug=${enc(slug)}`
      }
    ];
  }

  function renderLinks(list){
    linksBox.innerHTML = '';
    list.forEach(item=>{
      const wrap = document.createElement('div');
      wrap.innerHTML = `<div style="font-weight:700;margin-bottom:6px">${item.title}</div>
                        <a href="${item.url}" target="_blank" rel="noopener">${item.url}</a>`;
      linksBox.appendChild(wrap);
    });
    resultCard.style.display = 'block';
    // auto scroll
    resultCard.scrollIntoView({behavior:'smooth', block:'start'});
  }

  // ================== Events ==================
  qs('#btnGen').addEventListener('click', ()=>{
    const v = validate(); if(!v) return;
    // cache
    localStorage.setItem(LEADER_CACHE, JSON.stringify(v));
    const links = buildLinks(v);
    renderLinks(links);
    // simpan kombinasi "teks semua link" untuk copy/share
    const text = [
      `Nama Leader: ${v.name}`,
      `WA: ${v.wa}`,
      `Slug: ${v.slug}`,
      '',
      ...links.map(l => `${l.title}\n${l.url}`)
    ].join('\n');
    resultCard.dataset.bundle = text;
  });

  qs('#btnClear').addEventListener('click', ()=>{
    nameEl.value=''; waEl.value=''; slugEl.value='';
    resultCard.style.display='none';
  });

  qs('#btnCopy').addEventListener('click', async ()=>{
    const text = resultCard.dataset.bundle || '';
    try{
      await navigator.clipboard.writeText(text);
      alert('Semua link disalin âœ…');
    }catch(e){
      // fallback
      const ta = document.createElement('textarea');
      ta.value = text; document.body.appendChild(ta);
      ta.select(); document.execCommand('copy'); document.body.removeChild(ta);
      alert('Semua link disalin âœ…');
    }
  });

  qs('#btnShareWa').addEventListener('click', ()=>{
    const text = encodeURIComponent(resultCard.dataset.bundle || '');
    const url = `https://wa.me/?text=${text}`;
    window.open(url,'_blank');
  });
</script>
</body>
</html>
