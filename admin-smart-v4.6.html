<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>NPA Smart System | Hybrid Panel v2 (Leader)</title>
  <style>
    body{font-family:'Poppins',sans-serif;background:#f7f9fc;margin:0;padding:0;color:#333;}
    header{background:#0b3d91;color:white;text-align:center;padding:20px;font-size:1.4em;font-weight:bold;box-shadow:0 3px 10px rgba(0,0,0,.2);}
    .container{max-width:900px;margin:30px auto;background:white;padding:25px;border-radius:12px;box-shadow:0 4px 12px rgba(0,0,0,0.1);}
    h2{color:#d4380d;text-align:center;margin-top:0;}
    input{padding:10px;width:100%;border:1px solid #ccc;border-radius:8px;margin:8px 0;}
    .btn{display:inline-block;background:#0b3d91;color:white;padding:10px 16px;border:none;border-radius:8px;font-weight:600;cursor:pointer;transition:.3s;}
    .btn:hover{background:#072f6e;}
    table{width:100%;border-collapse:collapse;margin-top:20px;font-size:14px;}
    th,td{border:1px solid #ddd;padding:10px;text-align:left;}
    th{background:#0b3d91;color:white;}
    tr:nth-child(even){background:#f9f9f9;}
    .copy-btn{background:#25D366;color:white;border:none;padding:6px 10px;border-radius:6px;cursor:pointer;font-size:12px;}
    .footer{text-align:center;font-size:13px;color:#777;margin-top:30px;}
    .info{background:#e8f5e8;padding:12px;border-left:5px solid #28a745;border-radius:8px;margin:15px 0;}
    .whatsapp-btn{background:#25D366;color:white;padding:10px 20px;border:none;border-radius:8px;font-weight:600;cursor:pointer;margin-top:20px;}
    .whatsapp-btn:hover{background:#1ebe57;}
  </style>
</head>
<body>
  <header>NPA Smart System | Hybrid Panel v2 (Leader)</header>
  <div class="container">
    <h2>ðŸ“‹ Tambah Mitra Baru (Tanpa Token)</h2>
    <input type="text" id="leaderName" placeholder="Nama Lengkap Mitra *">
    <input type="tel" id="leaderPhone" placeholder="No. WhatsApp (628...) *">
    <button class="btn" id="addBtn">Tambah Mitra</button>

    <div id="msg" class="info" style="display:none;">Data tersimpan sementara.</div>

    <h2>ðŸ“– Daftar Mitra yang Ditambahkan</h2>
    <table id="leaderTable">
      <thead><tr><th>No</th><th>Nama</th><th>WhatsApp</th><th>LP Master</th><th>LP Hot</th><th>Form</th></tr></thead>
      <tbody id="leaderBody"><tr><td colspan="6" style="text-align:center;">Belum ada data mitra.</td></tr></tbody>
    </table>

    <button class="whatsapp-btn" id="sendAdmin">ðŸ“¤ Kirim Data ke Admin</button>

    <div style="text-align:center;margin-top:30px;">
      <a href="tools/npa-digital-assistant.html" class="btn">ðŸ¤– AI Tools</a>
      <a href="followup179.html" class="btn">ðŸ”” FollowUp179</a>
    </div>

    <div class="footer">Powered by NPA || 3iReborn Smart System</div>
  </div>

  <script>
    const base = "https://3ireborn.github.io/pendaftaran-online/";
    const tableBody = document.getElementById("leaderBody");
    const msg = document.getElementById("msg");
    const ADMIN_WA = "6285218453131"; // Nomor admin pusat

    let localLeaders = JSON.parse(localStorage.getItem("new_leaders") || "[]");

    function renderTable(){
      tableBody.innerHTML = "";
      if(localLeaders.length === 0){
        tableBody.innerHTML = `<tr><td colspan='6' style='text-align:center;'>Belum ada data mitra.</td></tr>`;
        return;
      }
      localLeaders.forEach((l,i)=>{
        const slug = l.slug;
        const lpMaster = `${base}master-lp.html?leader=${slug}`;
        const lpHot = `${base}lp-hot.html?leader=${slug}`;
        const form = `${base}index-v2.html?leader=${slug}`;
        tableBody.innerHTML += `
          <tr>
            <td>${i+1}</td>
            <td>${l.name}</td>
            <td>${l.phone}</td>
            <td><a href="${lpMaster}" target="_blank">Buka</a><br><button class="copy-btn" onclick="copyLink('${lpMaster}')">Copy</button></td>
            <td><a href="${lpHot}" target="_blank">Buka</a><br><button class="copy-btn" onclick="copyLink('${lpHot}')">Copy</button></td>
            <td><a href="${form}" target="_blank">Buka</a><br><button class="copy-btn" onclick="copyLink('${form}')">Copy</button></td>
          </tr>`;
      });
    }

    document.getElementById("addBtn").addEventListener("click",()=>{
      const name = document.getElementById("leaderName").value.trim();
      const phone = document.getElementById("leaderPhone").value.trim();
      if(!name || !phone){alert("Isi nama dan nomor WA dulu!");return;}
      const slug = name.toLowerCase().replace(/\s+/g,"-");
      const newLeader = {name,phone,slug,date:new Date().toLocaleString()};
      localLeaders.push(newLeader);
      localStorage.setItem("new_leaders", JSON.stringify(localLeaders));
      msg.style.display="block";
      renderTable();
    });

    document.getElementById("sendAdmin").addEventListener("click",()=>{
      if(localLeaders.length === 0) return alert("Belum ada mitra untuk dikirim!");
      let text = "ðŸ“‹ *LAPORAN MITRA BARU NPA Smart System*\n\n";
      text += `Leader: ${prompt("Masukkan nama Anda (Leader):")}\nTanggal: ${new Date().toLocaleDateString("id-ID")}\n\n`;
      localLeaders.forEach((l,i)=>{
        text += `${i+1}. ${l.name} - ${l.phone}\n`;
      });
      text += `\nTotal: ${localLeaders.length} mitra baru\n\nðŸ’Ž Generated by NPA Smart System â€“ 3iReborn Digital Ecosystem`;
      const url = `https://wa.me/${ADMIN_WA}?text=${encodeURIComponent(text)}`;
      window.open(url,"_blank");
    });

    function copyLink(txt){navigator.clipboard.writeText(txt);alert("Link disalin!");}

    renderTable();
  </script>
</body>
</html>
