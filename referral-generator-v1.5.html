<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Referral Generator v1.5 ‚Äî NPA Smart System</title>

<!-- Anti-cache -->
<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
<meta http-equiv="Pragma" content="no-cache" />
<meta http-equiv="Expires" content="0" />

<style>
    body {
        margin: 0;
        font-family: Poppins, sans-serif;
        background: #0b1220;
        color: #fff;
        padding: 20px;
    }

    h1 {
        text-align: center;
        font-size: 26px;
        color: #f1c40f;
        margin-bottom: 20px;
    }

    .card {
        background: #111827;
        border-radius: 16px;
        padding: 20px;
        margin-bottom: 20px;
        border: 2px solid #1e40af;
        box-shadow: 0 0 20px rgba(0,0,0,.4);
    }

    label {
        display: block;
        margin-bottom: 6px;
        font-weight: 600;
        color: #f1c40f;
    }

    input {
        width: 100%;
        padding: 14px;
        margin-bottom: 15px;
        border-radius: 10px;
        border: 2px solid #f1c40f;
        background: #0f172a;
        color: #fff;
        font-size: 15px;
    }

    input::placeholder {
        color: #9ca3af;
    }

    button {
        width: 100%;
        padding: 14px;
        background: #2563eb;
        border: none;
        border-radius: 10px;
        color: #fff;
        font-size: 16px;
        font-weight: 700;
        cursor: pointer;
        margin-top: 10px;
    }

    button:hover {
        background: #1e40af;
    }

    .preview-card {
        background: #0f172a;
        padding: 20px;
        border-radius: 16px;
        border: 2px solid #f1c40f;
        margin-top: 20px;
        text-align: center;
        display: none;
    }

    .qr-box {
        margin-top: 20px;
    }

    .social-card {
        margin-top: 20px;
        padding: 20px;
        border-radius: 20px;
        background: #111827;
        border: 3px solid #f1c40f;
        text-align: center;
        display: none;
    }

    #photoPreview {
        width: 100%;
        border-radius: 20px;
        margin-bottom: 10px;
    }

    .share-btn {
        background: #10b981;
        margin-top: 10px;
    }

    .copy-btn {
        background: #f59e0b;
        margin-top: 10px;
    }

    .download-btn {
        background: #ef4444;
        margin-top: 10px;
    }
</style>
</head>

<body>

<h1>Referral Generator v1.5<br>NPA Smart System</h1>

<div class="card">
    <label>Nama Leader</label>
    <input id="name" placeholder="contoh: Sugiarto Kurniawan">

    <label>Nomor WA Leader</label>
    <input id="wa" placeholder="628xxxx">

    <label>Slug (ID unik)</label>
    <input id="slug" placeholder="contoh: sugiarto-ksm">

    <label>Upload Foto (opsional)</label>
    <input type="file" accept="image/*" id="photoInput">
</div>

<button onclick="generate()">Buat Link & QR Code</button>

<div id="preview" class="preview-card"></div>

<div id="qrArea" class="qr-box"></div>

<div id="socialCard" class="social-card">
    <img id="photoPreview">
    <p id="socialName" style="font-size:18px;font-weight:700;color:#f1c40f;margin:5px 0;"></p>
    <p style="font-size:14px;color:#9ca3af">Scan QR untuk membuka link referral</p>
    <canvas id="socialQR"></canvas>

    <button class="copy-btn" onclick="copyAll()">Copy Semua Link</button>
    <button class="share-btn" onclick="shareWA()">Bagikan ke WhatsApp</button>
    <button class="download-btn" onclick="downloadCard()">Download Social Card</button>
</div>

<!-- QR Generator -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/qrious/4.0.2/qrious.min.js"></script>

<script>

function generate() {
    const name = document.getElementById("name").value.trim();
    const wa = document.getElementById("wa").value.trim();
    const slug = document.getElementById("slug").value.trim();

    if (!name || !wa || !slug) {
        alert("Isi semua data dulu beb üôè");
        return;
    }

    const base = "https://3ireborn.github.io/pendaftaran-online/";

    const lpMaster = `${base}lp-master-v6.6.html?leader=${slug}&wa=${wa}`;
    const lpHot = `${base}lp-hot-v6.6.html?leader=${slug}&wa=${wa}`;
    const form = `${base}index-v2.html?leader=${slug}&wa=${wa}`;

    const preview = document.getElementById("preview");
    preview.style.display = "block";
    preview.innerHTML = `
        <h3>üîó Link Siap Pakai</h3>
        <p>üåê LP Master:<br><a href="${lpMaster}" target="_blank">${lpMaster}</a></p>
        <p>üî• LP Hot:<br><a href="${lpHot}" target="_blank">${lpHot}</a></p>
        <p>üìù Form Pendaftaran:<br><a href="${form}" target="_blank">${form}</a></p>
    `;

    // QR untuk social card
    const qrCanvas = document.getElementById("socialQR");
    const qr = new QRious({
        element: qrCanvas,
        value: lpMaster,
        size: 220,
        background: "#0f172a",
        foreground: "#f1c40f"
    });

    // tampilkan social card
    const sCard = document.getElementById("socialCard");
    sCard.style.display = "block";
    document.getElementById("socialName").innerText = name;

    // upload foto ke preview
    const file = document.getElementById("photoInput").files[0];
    const photoPrev = document.getElementById("photoPreview");

    if (file) {
        const reader = new FileReader();
        reader.onload = e => photoPrev.src = e.target.result;
        reader.readAsDataURL(file);
    } else {
        photoPrev.src = "https://via.placeholder.com/600x400/111827/f1c40f?text=Social+Card";
    }

    // simpan untuk share WA
    window._allLinks = `üåê LP Master:\n${lpMaster}\n\nüî• LP Hot:\n${lpHot}\n\nüìù Form Pendaftaran:\n${form}`;
}

// COPY ALL LINKS
function copyAll() {
    navigator.clipboard.writeText(window._allLinks || "");
    alert("Semua link sudah disalin! üöÄ");
}

// SHARE WHATSAPP
function shareWA() {
    const url = "https://wa.me/?text=" + encodeURIComponent(window._allLinks);
    window.open(url, "_blank");
}

// DOWNLOAD SOCIAL CARD
function downloadCard() {
    html2canvas(document.getElementById("socialCard")).then(canvas => {
        const link = document.createElement("a");
        link.download = "social-card.png";
        link.href = canvas.toDataURL();
        link.click();
    });
}

</script>

<!-- html2canvas -->
<script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>

</body>
</html>
